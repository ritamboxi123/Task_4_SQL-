CREATE TABLE customers (
  customer_id INT,
  name VARCHAR2(50),
  email VARCHAR2(100),
  country VARCHAR2(50)
);

CREATE TABLE orders (
  order_id INT,
  customer_id INT,
  product VARCHAR2(50),
  total_amount NUMBER(10,2),
  order_date DATE
);
INSERT INTO customers VALUES 
(1, 'Ravi', 'ravi@example.com', 'India');
INSERT INTO customers VALUES 
(2, 'Sara', 'sara@example.com', 'USA');
INSERT INTO customers VALUES 
(3, 'Ali', 'ali@example.com', 'India');

INSERT INTO orders VALUES 
(101, 1, 'Shoes', 1500, TO_DATE('2024-01-05', 'YYYY-MM-DD'));
INSERT INTO orders VALUES 
(102, 2, 'Bag', 2500, TO_DATE('2024-02-10', 'YYYY-MM-DD'));
INSERT INTO orders VALUES 
(103, 1, 'Watch', 3000, TO_DATE('2024-03-15', 'YYYY-MM-DD'));
INSERT INTO orders VALUES 
(104, 3, 'Shoes', 1800, TO_DATE('2024-04-20', 'YYYY-MM-DD'));
SELECT * FROM orders;
SELECT * FROM customers
WHERE country = 'India';
SELECT * FROM orders
ORDER BY total_amount DESC;
SELECT customer_id, AVG(total_amount) AS average_spending
FROM orders
GROUP BY customer_id;

SELECT customer_id, SUM(total_amount) AS total_spending
FROM orders
GROUP BY customer_id;

SELECT c.name, o.product, o.total_amount
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id;

SELECT * FROM customers
WHERE customer_id IN (
  SELECT customer_id FROM orders
  WHERE total_amount > 2000
);

CREATE VIEW HighValueOrders AS
SELECT * FROM orders
WHERE total_amount > 2000;

SELECT * FROM HighValueOrders;

CREATE INDEX idx_customer_id ON orders(customer_id);